<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../../css/1.css">
    <link rel="stylesheet" href="../../css/bootstrap.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta2/css/all.min.css">
    <title>critère</title>
    <link href="./bootstrap/css/bootstrap.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="http://code.jquery.com/jquery.js"></script>
</head>

<script src="https://use.fontawesome.com/2887626415.js" crossorigin="anonymous"></script>
<header>
    <nav class="navbar sticky-top navbar-expand-lg navbar-light bg-transparent" style="margin:2%">
        <div class="container-fluid">
            <a class="navbar-brand" href="../../home.html">critère</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <i class="fas fa-bars"></i>
            </button>
            <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="../shop.html">SHOP</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">COLLECTION</a>
                    </li>
                    <li class="nav-item" id="nav-item-3">
                        <a class="nav-link" href="../about.html">ABOUT</a>
                    </li>
                    <li class="nav-item" id="nav-item-4">
                        <a class="navbar-cart" href="../cart.html"><img src="../../img/cart.png" id="cart"></a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

<body>
<div class="row">
    <div class="col-12" style="margin-bottom: 5%">
        <h1>FAQ Form</h1>
    </div>
</div>
<div class="container">
    <div class="row">
        <div class="col-md-12">
            <table class="table table-condensed justify-content-center">
                <thead>
                <tr align="center">
                    <th width="10%">TITLE</th>
                    <th width="60%">FAQ</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>DATE
                    </td>
                    <td>
                        2021-10-10 04:45:23
                    </td>
                </tr>
                <tr>
                    <td>TITLE
                    </td>
                    <td>

                    </td>
                </tr>
                </tbody>
            </table>
            <table id="commentTable" class="table table-condensed"></table>
            <table class="table table-condensed">
                <tr>
                    <td>
                                <span class="form-inline" role="form">
                                    <p>
                                    <div class="row">
                                        <div class="form-group col-6">
                                            <input type="text" id="commentParentName" name="commentParentName" class="form-control col-lg-2" data-rule-required="true" placeholder="ID" maxlength="10">
                                        </div>
                                        <div class="form-group col-6">
                                            <input type="password" id="commentParentPassword" name="commentParentPassword" class="form-control col-lg-2" data-rule-required="true" placeholder="PASSWORD" maxlength="10">
                                        </div>
                                    </div>
                                        <textarea id="commentParentText" class="form-control col-lg-12" placeholder="TEXT" style="width:100%; margin-top: 3%" rows="4"></textarea>
                                    </p>
                                    <button type="button" id="commentParentSubmit" name="commentParentSubmit" class="btn btn-default" style="float: right; margin-bottom: 2%">SUBMIT</button>
                                </span>
                    </td>
                </tr>
            </table>

            <script>

                $(function(){

                    $("#commentParentSubmit").click(function( event ) {

                        var pName = $("#commentParentName");
                        var pPassword = $("#commentParentPassword");
                        var pText = $("#commentParentText");

                        if($.trim(pName.val())==""){
                            alert("이름을 입력하세요.");
                            pName.focus();
                            return;
                        }else if($.trim(pPassword.val())==""){
                            alert("패스워드를 입력하세요.");
                            pPassword.focus();
                            return;
                        }else if($.trim(pText.val())==""){
                            alert("내용을 입력하세요.");
                            pText.focus();
                            return;
                        }

                        var commentParentText = '<tr id="r1" name="commentParentCode">'+
                            '<td colspan=2>'+
                            '<strong>'+pName.val()+'</strong> '+pPassword.val()+' <a style="cursor:pointer;" name="pAdd">답글</a> | <a style="cursor:pointer;" name="pDel">삭제</a><p>'+pText.val().replace(/\n/g, "<br>")+'</p>'+
                            '</td>'+
                            '</tr>';

                        if($('#commentTable').contents().size()==0){
                            $('#commentTable').append(commentParentText);
                        }else{
                            $('#commentTable tr:last').after(commentParentText);
                        }

                        $("#commentParentName").val("");
                        $("#commentParentPassword").val("");
                        $("#commentParentText").val("");

                    });

                    //댓글의 댓글을 다는 이벤트
                    $(document).on("click","#commentChildSubmit", function(){

                        var cName = $("#commentChildName");
                        var cPassword = $("#commentChildPassword");
                        var cText = $("#commentChildText");

                        if($.trim(cName.val())==""){
                            alert("이름을 입력하세요.");
                            cName.focus();
                            return;
                        }else if($.trim(cPassword.val())==""){
                            alert("패스워드를 입력하세요.");
                            cPassword.focus();
                            return;
                        }else if($.trim(cText.val())==""){
                            alert("내용을 입력하세요.");
                            cText.focus();
                            return;
                        }

                        var commentChildText = '<tr name="commentChildCode">'+
                            '<td style="width:1%"><span class="glyphicon glyphicon-arrow-right"></span></td>'+
                            '<td style="width:99%">'+
                            '<strong>'+cName.val()+'</strong> '+cPassword.val()+' <a style="cursor:pointer;" name="cAdd">답글</a> | <a style="cursor:pointer;" name="cDel">삭제</a>'+
                            '<p>'+cText.val().replace(/\n/g, "<br>")+'</p>'+
                            '</td>'+
                            '</tr>';

                        //앞의 tr노드 찾기
                        var prevTr = $(this).parent().parent().parent().parent().prev();
                        //댓글 적는 에디터 삭제
                        $("#commentEditor").remove();//여기에서 삭제를 해줘야 에디터tr을 안 찾는다.

                        //댓글을 타고 올라가며 부모 tr을 찾음
                        while(prevTr.attr("name")!="commentParentCode"){
                            prevTr = prevTr.prev();
                        }
                        //while를 타는지 체크
                        var check = false;
                        //다음 노드가 댓글(depth1)의 댓글인지 찾기위해 next
                        var nextTr = prevTr.next();
                        //뒤에 댓글(depth1)의 댓글(depth2_1)이 없다면 바로 붙인다.
                        if(nextTr.attr("name")!="commentChildCode"){
                            prevTr.after(commentChildText);
                        }else{
                            //댓글(depth1)의 댓글(depth2_n)이 있는경우 마지막까지 찾는다.
                            while(nextTr.attr("name")=="commentChildCode"){
                                nextTr = nextTr.next();
                                check = true;
                            }
                        }

                        if(check){//댓글(depth1)의 댓글(depth2_n)이 있다면 그 댓글(depth2_n) 뒤에 댓글(depth2_n+1) 추가
                            nextTr = nextTr.prev();//while문에서 검색하느라 next로 넘거갔던거 다시 앞으로 돌려줌
                            nextTr.after(commentChildText);
                        }

                    });

                    //답글링크를 눌렀을때 에디터 창을 뿌려주는 이벤트, 삭제링크를 눌렀을때 해당 댓글을 삭제하는 이벤트
                    $(document).on("click","table#commentTable a", function(){//동적으로 버튼이 생긴 경우 처리 방식

                        if($(this).attr("name")=="pDel"){
                            if (confirm("답글을 삭제 하시면 밑에 답글도 모두 삭제 됩니다. 정말 삭제하시겠습니까?") == true){    //확인

                                var delComment = $(this).parent().parent();
                                var nextTr = delComment.next();
                                var delTr;
                                //댓글(depth1)의 댓글(depth2_1)이 있는지 검사하여 삭제
                                while(nextTr.attr("name")=="commentCode"){
                                    nextTr = nextTr.next();
                                    delTr = nextTr.prev();//삭제하고 넘기면 삭제되서 없기 때문에 다음값을 가져오기 어려워 다시 앞으로 돌려서 찾은 다음 삭제
                                    delTr.remove();
                                }

                                delComment.remove();

                            }else{   //취소
                                return;
                            }
                        }else if($(this).attr("name")=="cDel"){
                            if (confirm("정말 삭제하시겠습니까??") == true){    //확인
                                $(this).parent().parent().remove();
                            }else{   //취소
                                return;
                            }
                        }else{
                            //자기 부모의 tr을 알아낸다.
                            var parentElement = $(this).parent().parent();
                            //댓글달기 창을 없앤다.
                            $("#commentEditor").remove();
                            //부모의 하단에 댓글달기 창을 삽입
                            var commentEditor = '<tr id="commentEditor">'+
                                '<td style="width:1%"> </td>'+
                                '<td>'+
                                '<span class="form-inline" role="form">'+
                                '<p>'+
                                '<div class="form-group">'+
                                '<input type="text" id="commentChildName" name="commentChildName" class="form-control col-lg-2" data-rule-required="true" placeholder="이름" maxlength="10">'+
                                '</div>'+
                                '<div class="form-group">'+
                                ' <input type="password" id="commentChildPassword" name="commentChildPassword" class="form-control col-lg-2" data-rule-required="true" placeholder="패스워드" maxlength="10">'+
                                '</div>'+
                                '<div class="form-group">'+
                                '<button type="button" id="commentChildSubmit" class="btn btn-default">확인</button>'+
                                '</div>'+
                                '</p>'+
                                '<textarea id="commentChildText" name="commentChildText" class="form-control" style="width:98%" rows="4"></textarea>'+
                                '</span>'+
                                '</td>'+
                                '</tr>';

                            parentElement.after(commentEditor);
                        }

                    });

                    $( "#list" ).click(function( event ) {
                        location.href='/community/notice';
                    });
                    $( "#modify" ).click(function( event ) {
                        location.href='/community/modify/notice/${community.id}';
                    });
                    $( "#delete" ).click(function( event ) {
                        location.href='/community/delete/notice/${community.id}';
                    });
                    $( "#write" ).click(function( event ) {
                        location.href='/community/notice/edit';
                    });
                });
            </script>
        </div>
    </div>
</div>
<footer class="page-footer font-small special-color-dark pt-4" id="footer">
    <section class="row">
        <div class="col-lg-4 col-md-4 col-sm-4 col-xs-6 align-self-center">
            <h6 class="text-uppercase mb-4 text-center">
                <a href="login.html" class="footer-item">Acoount</a></h6>
        </div>
        <div class="col-lg-4 col-md-4 col-sm-4 col-xs-6 align-self-center">
            <h6 class="text-uppercase mb-4 text-center">
                <a href="notice.html" class="footer-item">Notice</a></h6>
        </div>
        <div class="col-lg-4 col-md-4 col-sm-4 col-xs-6 align-self-center">
            <h6 class="text-uppercase mb-4 text-center">
                <a href="faq.html" class="footer-item">faq</a></h6>
        </div>
        <div class="col-lg-4 col-md-4 col-sm-4 col-xs-6 align-self-center">
            <h6 class="text-uppercase mb-4 text-center" style="font-size: small">
                c.s center</h6>
            <p style="text-align: center; line-height: 24px;">+82 10 1234 5678<br/>
                OPENING HOURS. AM 10 - PM 6<br/>
                LUNCH BREAK. PM 12 - PM 1</p>
        </div>
        <div class="col-lg-4 col-md-4 col-sm-4 col-xs-6 align-self-center">
            <h6 class="text-uppercase mb-4 text-center" style="font-size: small">
                location</h6>
            <p style="text-align: center; line-height: 24px;">4F, 7, JANGCHUNGDAN-RO 4-GIL,<br/>
                JUNG-GU, SEOUL, SOUTH KOREA</p>
        </div>
        <div class="col-lg-2 col-md-2 col-sm-2 col-xs-2 align-self-center">
            <a href="#" class="footer-item2">INSTAGRAM</a>
        </div>
        <div class="col-lg-2 col-md-2 col-sm-2 col-xs-2 align-self-center">
            <a href="#" class="footer-item2">FACEBOOK</a>
        </div>
        <div class="footer-copyright text-center py-3">© 2021
            <a>critère</a>
        </div>
    </section>
</footer>

</body>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script type="text/javascript" src="../js/bootstrap.js"></script>
</html>